<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ERC-8004 Trustless zkML Agents</title>
    <style>
        :root {
            --bg-primary: #0a0e1a;
            --bg-secondary: #131821;
            --bg-tertiary: #1a1f2e;
            --text-primary: #ffffff;
            --text-secondary: #a0aec0;
            --accent-blue: #5b8cff;
            --accent-teal: #4de2cf;
            --accent-green: #10b981;
            --accent-red: #ef4444;
            --accent-yellow: #fbbf24;
            --border-color: #2d3748;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
        }

        /* Header */
        .header {
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            padding: 24px;
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(10px);
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 24px;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .logo {
            font-size: 32px;
            font-weight: 700;
            background: linear-gradient(135deg, var(--accent-blue), var(--accent-teal));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .badge {
            background: var(--bg-tertiary);
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 600;
            color: var(--accent-teal);
            border: 1px solid var(--accent-teal);
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: var(--bg-tertiary);
            border-radius: 8px;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--accent-green);
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Main Container */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 24px;
        }

        /* Hero Section */
        .hero {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-tertiary) 100%);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 48px;
            margin-bottom: 32px;
            text-align: center;
        }

        .hero h1 {
            font-size: 48px;
            margin-bottom: 16px;
            background: linear-gradient(135deg, var(--text-primary), var(--accent-teal));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .hero p {
            font-size: 20px;
            color: var(--text-secondary);
            margin-bottom: 32px;
        }

        .workflow {
            display: flex;
            justify-content: center;
            gap: 16px;
            flex-wrap: wrap;
            margin-top: 32px;
        }

        .workflow-step {
            background: var(--bg-primary);
            padding: 16px 24px;
            border-radius: 12px;
            border: 1px solid var(--border-color);
            min-width: 150px;
            position: relative;
        }

        .workflow-step.active {
            border-color: var(--accent-blue);
            box-shadow: 0 0 20px rgba(91, 140, 255, 0.3);
        }

        .workflow-step::after {
            content: '→';
            position: absolute;
            right: -24px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-secondary);
            font-size: 24px;
        }

        .workflow-step:last-child::after {
            display: none;
        }

        .step-number {
            font-size: 12px;
            color: var(--accent-teal);
            font-weight: 600;
            margin-bottom: 8px;
        }

        .step-title {
            font-size: 14px;
            font-weight: 600;
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 24px;
            margin-bottom: 32px;
        }

        .stat-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 24px;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .stat-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow);
        }

        .stat-label {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }

        .stat-value {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .stat-value.good {
            color: var(--accent-green);
        }

        .stat-value.bad {
            color: var(--accent-red);
        }

        .stat-value.neutral {
            color: var(--accent-yellow);
        }

        .stat-subtitle {
            font-size: 12px;
            color: var(--text-secondary);
        }

        /* Dashboard Grid */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(450px, 1fr));
            gap: 24px;
            margin-bottom: 32px;
        }

        .dashboard-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 24px;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--border-color);
        }

        .card-title {
            font-size: 20px;
            font-weight: 600;
        }

        .card-badge {
            padding: 4px 12px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 600;
        }

        .card-badge.oracle {
            background: rgba(91, 140, 255, 0.2);
            color: var(--accent-blue);
        }

        .card-badge.agent {
            background: rgba(77, 226, 207, 0.2);
            color: var(--accent-teal);
        }

        .card-badge.registry {
            background: rgba(251, 191, 36, 0.2);
            color: var(--accent-yellow);
        }

        /* Classification List */
        .classification-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
            max-height: 400px;
            overflow-y: auto;
        }

        .classification-item {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 16px;
            transition: all 0.2s;
        }

        .classification-item:hover {
            border-color: var(--accent-blue);
        }

        .classification-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 12px;
        }

        .classification-headline {
            font-size: 14px;
            font-weight: 600;
            flex: 1;
            margin-right: 16px;
        }

        .sentiment-badge {
            padding: 4px 12px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 600;
            white-space: nowrap;
        }

        .sentiment-badge.good {
            background: rgba(16, 185, 129, 0.2);
            color: var(--accent-green);
        }

        .sentiment-badge.bad {
            background: rgba(239, 68, 68, 0.2);
            color: var(--accent-red);
        }

        .sentiment-badge.neutral {
            background: rgba(251, 191, 36, 0.2);
            color: var(--accent-yellow);
        }

        .classification-meta {
            display: flex;
            gap: 16px;
            font-size: 12px;
            color: var(--text-secondary);
        }

        .classification-meta span {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        /* Trade List */
        .trade-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
            max-height: 400px;
            overflow-y: auto;
        }

        .trade-item {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 16px;
        }

        .trade-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .trade-action {
            font-size: 14px;
            font-weight: 600;
        }

        .trade-pnl {
            font-size: 16px;
            font-weight: 700;
        }

        .trade-pnl.positive {
            color: var(--accent-green);
        }

        .trade-pnl.negative {
            color: var(--accent-red);
        }

        .trade-pnl.pending {
            color: var(--text-secondary);
        }

        .trade-details {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
            font-size: 12px;
            color: var(--text-secondary);
        }

        /* Registry Table */
        .registry-table {
            width: 100%;
            border-collapse: collapse;
        }

        .registry-table th {
            text-align: left;
            padding: 12px;
            background: var(--bg-tertiary);
            border-bottom: 1px solid var(--border-color);
            font-size: 12px;
            color: var(--text-secondary);
            font-weight: 600;
            text-transform: uppercase;
        }

        .registry-table td {
            padding: 12px;
            border-bottom: 1px solid var(--border-color);
            font-size: 14px;
        }

        .registry-table tr:hover {
            background: var(--bg-tertiary);
        }

        .reputation-bar {
            width: 100%;
            height: 8px;
            background: var(--bg-primary);
            border-radius: 4px;
            overflow: hidden;
        }

        .reputation-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-red), var(--accent-yellow), var(--accent-green));
            transition: width 0.3s;
        }

        /* Portfolio Card */
        .portfolio-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
        }

        .portfolio-item {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 16px;
        }

        .portfolio-label {
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }

        .portfolio-value {
            font-size: 24px;
            font-weight: 700;
            color: var(--accent-teal);
        }

        /* Buttons */
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--accent-blue);
            color: white;
        }

        .btn-primary:hover {
            background: #4a7ae6;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(91, 140, 255, 0.4);
        }

        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .btn-secondary:hover {
            border-color: var(--accent-teal);
            transform: translateY(-2px);
        }

        /* Loading Spinner */
        .spinner {
            width: 16px;
            height: 16px;
            border: 2px solid transparent;
            border-top-color: currentColor;
            border-radius: 50%;
            animation: spin 0.6s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 48px 24px;
            color: var(--text-secondary);
        }

        .empty-state-icon {
            font-size: 48px;
            margin-bottom: 16px;
            opacity: 0.3;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }

            .workflow {
                flex-direction: column;
                align-items: center;
            }

            .workflow-step::after {
                content: '↓';
                right: 50%;
                top: auto;
                bottom: -24px;
                transform: translateX(50%);
            }
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-tertiary);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border-color);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--accent-blue);
        }

        /* Info Tooltip */
        .info-icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: var(--bg-tertiary);
            color: var(--accent-blue);
            font-size: 12px;
            font-weight: 700;
            cursor: help;
            margin-left: 8px;
            border: 1px solid var(--border-color);
            position: relative;
            transition: all 0.2s;
        }

        .info-icon:hover {
            background: var(--accent-blue);
            color: white;
            border-color: var(--accent-blue);
            transform: scale(1.1);
        }

        .tooltip {
            position: absolute;
            bottom: calc(100% + 12px);
            left: 50%;
            transform: translateX(-50%);
            background: var(--bg-tertiary);
            border: 1px solid var(--accent-blue);
            border-radius: 8px;
            padding: 12px 16px;
            min-width: 280px;
            max-width: 400px;
            font-size: 13px;
            font-weight: 400;
            line-height: 1.5;
            color: var(--text-primary);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.5);
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.2s, visibility 0.2s;
            pointer-events: none;
            white-space: normal;
        }

        .tooltip::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 6px solid transparent;
            border-top-color: var(--accent-blue);
        }

        .info-icon:hover .tooltip {
            opacity: 1;
            visibility: visible;
        }

        /* Proof Hash */
        .proof-hash {
            font-family: 'Courier New', monospace;
            font-size: 11px;
            color: var(--accent-teal);
            word-break: break-all;
        }

        /* Transaction Links - Prevent overflow */
        a[href*="basescan.org"] {
            word-break: break-all;
            overflow-wrap: break-word;
            display: inline-block;
            max-width: 100%;
        }

        /* zkML Proof Generation Banner */
        .proof-generation-banner {
            position: fixed;
            top: 80px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, rgba(91, 140, 255, 0.95), rgba(77, 226, 207, 0.95));
            backdrop-filter: blur(10px);
            border: 2px solid var(--accent-teal);
            border-radius: 12px;
            padding: 16px 32px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
            z-index: 1000;
            display: none;
            align-items: center;
            gap: 16px;
            animation: slideDown 0.3s ease-out;
        }

        .proof-generation-banner.active {
            display: flex;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateX(-50%) translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(-50%) translateY(0);
            }
        }

        .proof-spinner {
            width: 24px;
            height: 24px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        .proof-banner-text {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .proof-banner-title {
            font-size: 16px;
            font-weight: 700;
            color: white;
        }

        .proof-banner-subtitle {
            font-size: 13px;
            color: rgba(255, 255, 255, 0.9);
        }

        .proof-timer {
            background: rgba(0, 0, 0, 0.3);
            padding: 8px 16px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 18px;
            font-weight: 700;
            color: white;
            min-width: 80px;
            text-align: center;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo-section">
                <img src="https://cdn.prod.website-files.com/65d52b07d5bc41614daa723f/665df12739c532f45b665fe7_logo-novanet.svg" alt="NovaNET" style="height: 32px;">
                <span style="font-size: 29px; font-weight: 700; color: var(--text-primary);">zkML for ERC-8004</span>
            </div>
            <div style="display: flex; align-items: center; gap: 16px;">
                <!-- About Button -->
                <div style="background: var(--bg-tertiary); border: 1px solid var(--accent-teal); border-radius: 8px; padding: 10px 16px; cursor: pointer; transition: all 0.2s;" onclick="document.getElementById('about-modal').style.display = 'flex'" onmouseover="this.style.borderColor='var(--accent-blue)'" onmouseout="this.style.borderColor='var(--accent-teal)'">
                    <span style="font-weight: 600; font-size: 14px; color: var(--accent-teal);">About</span>
                </div>

                <!-- GitHub Link -->
                <a href="https://github.com/hshadab/zkml-erc8004" target="_blank" style="display: flex; align-items: center; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 8px; padding: 10px; cursor: pointer; transition: all 0.2s; text-decoration: none;" onmouseover="this.style.borderColor='var(--accent-teal)'" onmouseout="this.style.borderColor='var(--border-color)'">
                    <svg height="20" width="20" viewBox="0 0 16 16" fill="currentColor" style="color: var(--text-primary);">
                        <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path>
                    </svg>
                </a>

                <div class="status-indicator">
                    <div class="status-dot"></div>
                    <span id="status-text" style="font-size: 20px; font-weight: 700;">Live on Base</span>
                </div>
                <!-- API Docs Widget -->
                <div style="background: var(--bg-tertiary); border: 1px solid var(--accent-blue); border-radius: 8px; padding: 10px 16px; cursor: pointer; transition: all 0.2s;" onclick="document.getElementById('api-docs-modal').style.display = 'flex'" onmouseover="this.style.borderColor='var(--accent-teal)'" onmouseout="this.style.borderColor='var(--accent-blue)'">
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <span style="font-size: 20px;">📖</span>
                        <span style="font-size: 20px; font-weight: 700; color: var(--accent-blue);">API Docs</span>
                    </div>
                </div>
                <!-- x402 Compact Widget -->
                <div style="background: var(--bg-tertiary); border: 1px solid var(--accent-teal); border-radius: 8px; padding: 10px 16px; cursor: pointer; transition: all 0.2s;" onclick="document.getElementById('x402-modal').style.display = 'flex'">
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <span style="font-size: 20px;">💳</span>
                        <span style="font-size: 20px; font-weight: 700; color: var(--accent-teal);">x402 Service</span>
                        <span style="font-size: 18px; font-weight: 600; color: var(--text-secondary);" id="x402-widget-price">$0.25</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- zkML Proof Generation Banner -->
    <div class="proof-generation-banner" id="proof-banner">
        <div class="proof-spinner"></div>
        <div class="proof-banner-text">
            <div class="proof-banner-title">Generating zkML Proof</div>
            <div class="proof-banner-subtitle">ONNX Inference → JOLT Proof → Groth16 Wrapper → On-Chain</div>
        </div>
        <div class="proof-timer" id="proof-timer">0s</div>
    </div>

    <!-- Main Content -->
    <div class="container">
        <!-- Hero Section -->
        <section class="hero">
            <h1>Trustless DeFi Agents</h1>
            <p>zkML-powered sentiment analysis with on-chain proof verification and autonomous trading</p>

            <div class="workflow">
                <div class="workflow-step" id="step-1">
                    <div class="step-number">STEP 1</div>
                    <div class="step-title">Fetch News</div>
                </div>
                <div class="workflow-step" id="step-2">
                    <div class="step-number">STEP 2</div>
                    <div class="step-title">ML Classify</div>
                </div>
                <div class="workflow-step" id="step-3">
                    <div class="step-number">STEP 3</div>
                    <div class="step-title">Generate Proof</div>
                </div>
                <div class="workflow-step" id="step-4">
                    <div class="step-number">STEP 4</div>
                    <div class="step-title">Post On-Chain</div>
                </div>
                <div class="workflow-step" id="step-5">
                    <div class="step-number">STEP 5</div>
                    <div class="step-title">Agent Trades</div>
                </div>
            </div>
        </section>

        <!-- Dashboard Grid -->
        <div class="dashboard-grid">
            <!-- Oracle Dashboard -->
            <div class="dashboard-card">
                <div class="card-header">
                    <h2 class="card-title">
                        📰 News Classifications
                        <span class="info-icon">ⓘ
                            <span class="tooltip">These are crypto news articles analyzed by our AI model. Each article is classified as Good News, Bad News, or Neutral using a real neural network. The AI's decision is cryptographically proven with zero-knowledge proofs and verified on the blockchain.</span>
                        </span>
                    </h2>
                    <span class="card-badge oracle">ORACLE</span>
                </div>
                <div class="classification-list" id="classification-list">
                    <div class="empty-state">
                        <div class="empty-state-icon">📊</div>
                        <p>Loading classifications...</p>
                    </div>
                </div>
            </div>

            <!-- Trading Agent Dashboard -->
            <div class="dashboard-card">
                <div class="card-header">
                    <h2 class="card-title">
                        💼 Agent Trades
                        <span class="info-icon">ⓘ
                            <span class="tooltip">This autonomous trading agent reads news classifications from the blockchain and automatically executes cryptocurrency trades. When it sees Good News, it buys ETH. When it sees Bad News, it sells ETH. All trades happen on-chain using real funds.</span>
                        </span>
                    </h2>
                    <span class="card-badge agent">AGENT</span>
                </div>
                <div class="trade-list" id="trade-list">
                    <div class="empty-state">
                        <div class="empty-state-icon">💹</div>
                        <p>Loading trades...</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Portfolio and Registry -->
        <div class="dashboard-grid">
            <!-- Portfolio -->
            <div class="dashboard-card">
                <div class="card-header">
                    <h2 class="card-title">
                        💰 Agent Portfolio
                        <span class="info-icon">ⓘ
                            <span class="tooltip">This shows the trading agent's current cryptocurrency holdings. The agent holds ETH (Ethereum) and USDC (US Dollar Coin) in its wallet. These are real tokens on Base blockchain that the agent trades automatically based on news sentiment.</span>
                        </span>
                    </h2>
                    <span class="card-badge agent">LIVE</span>
                </div>
                <div style="margin-bottom: 16px; padding: 12px; background: var(--bg-tertiary); border-radius: 8px; border: 1px solid var(--border-color);">
                    <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 8px;">💼 Agent Wallet Address</div>
                    <a href="https://basescan.org/address/0xBC2a8f872f02CCd2356F235675f756A4FdCAd81d" target="_blank" style="text-decoration: none;">
                        <div class="proof-hash" style="color: var(--accent-blue); cursor: pointer; transition: color 0.2s;" onmouseover="this.style.color='var(--accent-teal)'" onmouseout="this.style.color='var(--accent-blue)'">0xBC2a8f872f02CCd2356F235675f756A4FdCAd81d</div>
                    </a>
                </div>
                <div class="portfolio-grid" id="portfolio-grid">
                    <div class="portfolio-item">
                        <div class="portfolio-label">ETH Balance</div>
                        <div class="portfolio-value" id="weth-balance">-</div>
                    </div>
                    <div class="portfolio-item">
                        <div class="portfolio-label">USDC Balance</div>
                        <div class="portfolio-value" id="usdc-balance">-</div>
                    </div>
                    <div class="portfolio-item">
                        <div class="portfolio-label">Total Value</div>
                        <div class="portfolio-value" id="total-value">-</div>
                    </div>
                    <div class="portfolio-item">
                        <div class="portfolio-label">P&L (24h)</div>
                        <div class="portfolio-value" id="pnl-24h">-</div>
                    </div>
                </div>
            </div>

            <!-- ERC-8004 Registry -->
            <div class="dashboard-card">
                <div class="card-header">
                    <h2 class="card-title">
                        🏛️ ERC-8004 Registry
                        <span class="info-icon">ⓘ
                            <span class="tooltip">ERC-8004 is a blockchain standard for AI agent identities and work validation. This registry tracks which AI agents are registered on the network, monitors their reputation scores, and coordinates validation requests between agents. Think of it as a trust system for AI work.</span>
                        </span>
                    </h2>
                    <span class="card-badge registry">REGISTRY</span>
                </div>
                <div style="margin-bottom: 16px; padding: 12px; background: var(--bg-tertiary); border-radius: 8px; border: 1px solid var(--border-color);">
                    <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 8px;">🏛️ ValidationRegistry Contract Address</div>
                    <a href="https://basescan.org/address/0x44fBb986C8705A1de9951131a48D8eBc142c08E6" target="_blank" style="text-decoration: none;">
                        <div class="proof-hash" id="validation-registry-address" style="color: var(--accent-blue); cursor: pointer; transition: color 0.2s;" onmouseover="this.style.color='var(--accent-teal)'" onmouseout="this.style.color='var(--accent-blue)'">0x44fBb986C8705A1de9951131a48D8eBc142c08E6</div>
                    </a>
                </div>
                <div style="margin-bottom: 20px;">
                    <h3 style="font-size: 14px; font-weight: 600; margin-bottom: 12px; color: var(--text-primary);">
                        Registered Agents
                        <span class="info-icon">ⓘ
                            <span class="tooltip">Each AI agent on the network gets a unique NFT (token) as its identity. Agents earn reputation points (0-1000) by completing accurate work. Higher reputation means more trustworthy AI. Our news classifier Oracle has Token ID #1.</span>
                        </span>
                    </h3>
                    <table class="registry-table">
                        <thead>
                            <tr>
                                <th>Token ID</th>
                                <th>Capability</th>
                                <th>Reputation</th>
                            </tr>
                        </thead>
                        <tbody id="registry-tbody">
                            <tr>
                                <td colspan="3">
                                    <div class="empty-state">
                                        <div class="empty-state-icon">🔐</div>
                                        <p>Loading registry...</p>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div style="margin-bottom: 16px;">
                    <h3 style="font-size: 14px; font-weight: 600; margin-bottom: 12px; color: var(--text-primary);">
                        Recent Validation Requests
                        <span class="info-icon">ⓘ
                            <span class="tooltip">When our Oracle AI classifies news, it creates a validation request asking other AI agents to verify the work. This table shows pending, approved, or rejected validations. Other agents can validate the Oracle's work to build trust in the network.</span>
                        </span>
                    </h3>
                    <table class="registry-table">
                        <thead>
                            <tr>
                                <th>Classification ID</th>
                                <th>Agent Token</th>
                                <th>Status</th>
                                <th>Responses</th>
                                <th>Request Time</th>
                            </tr>
                        </thead>
                        <tbody id="validations-tbody">
                            <tr>
                                <td colspan="5">
                                    <div class="empty-state">
                                        <div class="empty-state-icon">⏳</div>
                                        <p>Loading validation history...</p>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Stats Grid -->
        <div class="stats-grid" id="stats-grid" style="margin-bottom: 32px;">
            <div class="stat-card">
                <div class="stat-label">🔐 Oracle Reputation</div>
                <div class="stat-value" id="oracle-reputation">-</div>
                <div class="stat-subtitle">ERC-8004 Trust Score</div>
                <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid var(--border-color); display: flex; justify-content: space-between; font-size: 12px; color: var(--text-secondary);">
                    <span id="oracle-proofs">- proofs</span>
                    <span id="oracle-accuracy">-% accurate</span>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Total Trades</div>
                <div class="stat-value" id="total-trades">-</div>
                <div class="stat-subtitle">Autonomous executions</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Win Rate</div>
                <div class="stat-value good" id="win-rate">-</div>
                <div class="stat-subtitle">10-second profitability</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Total Classifications</div>
                <div class="stat-value" id="total-classifications">-</div>
                <div class="stat-subtitle">All-time on Base</div>
            </div>
        </div>

        <!-- X402 Modal -->
        <div id="x402-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.8); z-index: 2000; align-items: center; justify-content: center;">
            <div style="background: var(--bg-secondary); border: 1px solid var(--accent-teal); border-radius: 16px; padding: 32px; max-width: 600px; width: 90%; max-height: 90vh; overflow-y: auto; position: relative;">
                <button onclick="document.getElementById('x402-modal').style.display = 'none'" style="position: absolute; top: 16px; right: 16px; background: none; border: none; color: var(--text-secondary); font-size: 24px; cursor: pointer; padding: 0; width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; border-radius: 4px; transition: all 0.2s;" onmouseover="this.style.background='var(--bg-tertiary)'; this.style.color='var(--text-primary)'" onmouseout="this.style.background='none'; this.style.color='var(--text-secondary)'">×</button>

                <div class="card-header" style="border: none; padding: 0; margin-bottom: 24px;">
                    <h2 class="card-title">
                        💳 x402 Full Demo Experience
                        <span class="info-icon">ⓘ
                            <span class="tooltip">Pay $0.25 USDC to get the complete autonomous AI demo: zkML classification + cryptographic proof + live autonomous trade execution. Watch your payment trigger a real on-chain trade! Powered by HTTP 402 Payment Required protocol.</span>
                        </span>
                    </h2>
                </div>

                <!-- Pricing Information -->
                <div style="background: linear-gradient(135deg, rgba(91, 140, 255, 0.1), rgba(77, 226, 207, 0.1)); border: 1px solid var(--accent-teal); border-radius: 12px; padding: 20px; margin-bottom: 20px;">
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px;">
                        <div>
                            <div style="font-size: 14px; color: var(--text-secondary); margin-bottom: 4px;">Service Price</div>
                            <div style="font-size: 28px; font-weight: 700; color: var(--accent-teal);" id="x402-price">$0.25 USDC</div>
                        </div>
                        <div style="text-align: right;">
                            <div style="font-size: 12px; color: var(--text-secondary);">Network</div>
                            <div style="font-size: 14px; font-weight: 600; color: var(--text-primary);">Base Mainnet</div>
                        </div>
                    </div>
                    <div style="background: var(--bg-tertiary); border-radius: 8px; padding: 12px; margin-bottom: 12px;">
                        <div style="font-size: 11px; color: var(--text-secondary); margin-bottom: 6px;">💰 USDC Payment Recipient</div>
                        <div class="proof-hash" id="x402-recipient" style="color: var(--accent-blue); font-size: 11px;">Loading...</div>
                    </div>
                    <div style="font-size: 12px; color: var(--text-secondary); line-height: 1.8;">
                        ✨ zkML Classification + Groth16 Proof<br/>
                        🤖 Autonomous Trade Execution<br/>
                        📊 Live BaseScan Transaction Links
                    </div>
                </div>

                <!-- Payment Form -->
                <div style="background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 12px; padding: 20px; margin-bottom: 20px;">
                    <h3 style="font-size: 16px; font-weight: 700; margin-bottom: 16px;">
                        🎯 Request Classification
                    </h3>

                    <!-- Step 1: Enter Headline -->
                    <div style="margin-bottom: 16px;">
                        <label style="display: block; font-size: 13px; font-weight: 600; margin-bottom: 6px; color: var(--text-primary);">
                            1️⃣ Enter Headline to Classify
                        </label>
                        <input
                            type="text"
                            id="x402-headline"
                            placeholder="e.g., Bitcoin ETF approved by SEC"
                            style="width: 100%; padding: 10px 14px; background: var(--bg-primary); border: 1px solid var(--border-color); border-radius: 8px; color: var(--text-primary); font-size: 13px; font-family: inherit;"
                        />
                    </div>

                    <!-- Step 2: Send Payment -->
                    <div style="margin-bottom: 16px; padding: 12px; background: var(--bg-primary); border-radius: 8px; border-left: 4px solid var(--accent-teal);">
                        <label style="display: block; font-size: 13px; font-weight: 600; margin-bottom: 8px; color: var(--text-primary);">
                            2️⃣ Send USDC Payment on Base Mainnet
                        </label>
                        <div style="font-size: 12px; color: var(--text-secondary); line-height: 1.5;">
                            Transfer <strong style="color: var(--accent-teal);">$0.25 USDC</strong> to the recipient address above using MetaMask or any Base wallet.<br>
                            ⚠️ Make sure you're on <strong>Base Mainnet (Chain ID 8453)</strong>
                        </div>
                    </div>

                    <!-- Step 3: Enter TX Hash -->
                    <div style="margin-bottom: 16px;">
                        <label style="display: block; font-size: 13px; font-weight: 600; margin-bottom: 6px; color: var(--text-primary);">
                            3️⃣ Enter USDC Transfer Transaction Hash
                        </label>
                        <input
                            type="text"
                            id="x402-payment-tx"
                            placeholder="0x..."
                            style="width: 100%; padding: 10px 14px; background: var(--bg-primary); border: 1px solid var(--border-color); border-radius: 8px; color: var(--text-primary); font-size: 13px; font-family: 'Courier New', monospace;"
                        />
                    </div>

                    <!-- Submit Button -->
                    <button
                        id="x402-submit-btn"
                        class="btn btn-primary"
                        onclick="submitX402Classification()"
                        style="width: 100%; justify-content: center; font-size: 14px; padding: 12px 20px;"
                    >
                        🚀 Get zkML Classification
                    </button>
                </div>

                <!-- Results Display -->
                <div id="x402-results" style="display: none; background: var(--bg-tertiary); border: 1px solid var(--accent-green); border-radius: 12px; padding: 20px;">
                    <h3 style="font-size: 16px; font-weight: 700; margin-bottom: 16px; color: var(--accent-green);">
                        ✅ Classification Results
                    </h3>
                    <div id="x402-results-content"></div>
                </div>

                <!-- Error Display -->
                <div id="x402-error" style="display: none; background: rgba(239, 68, 68, 0.1); border: 1px solid var(--accent-red); border-radius: 12px; padding: 16px;">
                    <h3 style="font-size: 14px; font-weight: 700; margin-bottom: 10px; color: var(--accent-red);">
                        ❌ Error
                    </h3>
                    <div id="x402-error-content" style="font-size: 13px; color: var(--text-primary);"></div>
                </div>
            </div>
        </div>

        <!-- API Documentation Modal -->
        <div id="api-docs-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.8); z-index: 2000; align-items: center; justify-content: center;">
            <div style="background: var(--bg-secondary); border: 1px solid var(--accent-blue); border-radius: 16px; padding: 32px; max-width: 800px; width: 90%; max-height: 90vh; overflow-y: auto; position: relative;">
                <button onclick="document.getElementById('api-docs-modal').style.display = 'none'" style="position: absolute; top: 16px; right: 16px; background: none; border: none; color: var(--text-secondary); font-size: 24px; cursor: pointer; padding: 0; width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; border-radius: 4px; transition: all 0.2s;" onmouseover="this.style.background='var(--bg-tertiary)'; this.style.color='var(--text-primary)'" onmouseout="this.style.background='none'; this.style.color='var(--text-secondary)'">×</button>

                <div class="card-header" style="border: none; padding: 0; margin-bottom: 24px;">
                    <h2 class="card-title" style="color: var(--accent-blue);">
                        📖 API Documentation
                    </h2>
                    <p style="font-size: 14px; color: var(--text-secondary); margin-top: 8px;">
                        Integrate zkML news classification into your applications
                    </p>
                </div>

                <!-- Base URL -->
                <div style="background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 12px; padding: 16px; margin-bottom: 24px;">
                    <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 6px; font-weight: 600;">BASE URL</div>
                    <code style="font-family: 'Courier New', monospace; color: var(--accent-teal); font-size: 14px;">http://localhost:3000</code>
                </div>

                <!-- Endpoint 1: GET /api/pricing -->
                <div style="margin-bottom: 32px;">
                    <h3 style="font-size: 16px; font-weight: 700; margin-bottom: 12px; color: var(--text-primary);">
                        <span style="background: var(--accent-green); color: black; padding: 4px 8px; border-radius: 4px; font-size: 11px; margin-right: 8px; font-weight: 700;">GET</span>
                        /api/pricing
                    </h3>
                    <p style="font-size: 13px; color: var(--text-secondary); margin-bottom: 12px;">Get service pricing information and payment details</p>

                    <div style="background: var(--bg-primary); border: 1px solid var(--border-color); border-radius: 8px; padding: 12px; margin-bottom: 12px;">
                        <div style="font-size: 11px; color: var(--text-secondary); margin-bottom: 6px; font-weight: 600;">EXAMPLE REQUEST</div>
                        <pre style="margin: 0; font-family: 'Courier New', monospace; font-size: 12px; color: var(--text-primary); overflow-x: auto;">curl http://localhost:3000/api/pricing</pre>
                    </div>

                    <div style="background: var(--bg-primary); border: 1px solid var(--border-color); border-radius: 8px; padding: 12px;">
                        <div style="font-size: 11px; color: var(--text-secondary); margin-bottom: 6px; font-weight: 600;">EXAMPLE RESPONSE</div>
                        <pre style="margin: 0; font-family: 'Courier New', monospace; font-size: 11px; color: var(--text-primary); overflow-x: auto; line-height: 1.6;">{
  "service": "zkML News Classification",
  "price": "$0.25",
  "currency": "USDC",
  "usdcAddress": "0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913",
  "recipient": "0x4E3eD682f723DD133252aae032D32f1Ef7EEafb4",
  "network": "Base Mainnet (Chain ID: 8453)"
}</pre>
                    </div>
                </div>

                <!-- Endpoint 2: POST /api/classify -->
                <div style="margin-bottom: 32px;">
                    <h3 style="font-size: 16px; font-weight: 700; margin-bottom: 12px; color: var(--text-primary);">
                        <span style="background: var(--accent-blue); color: white; padding: 4px 8px; border-radius: 4px; font-size: 11px; margin-right: 8px; font-weight: 700;">POST</span>
                        /api/classify
                    </h3>
                    <p style="font-size: 13px; color: var(--text-secondary); margin-bottom: 12px;">Submit a headline for zkML classification (requires payment)</p>

                    <div style="background: var(--bg-primary); border: 1px solid var(--border-color); border-radius: 8px; padding: 12px; margin-bottom: 12px;">
                        <div style="font-size: 11px; color: var(--text-secondary); margin-bottom: 6px; font-weight: 600;">REQUEST BODY</div>
                        <pre style="margin: 0; font-family: 'Courier New', monospace; font-size: 11px; color: var(--text-primary); overflow-x: auto; line-height: 1.6;">{
  "headline": "Bitcoin ETF approved by SEC",
  "paymentTx": "0xYOUR_USDC_TRANSFER_TX_HASH"
}</pre>
                    </div>

                    <div style="background: var(--bg-primary); border: 1px solid var(--border-color); border-radius: 8px; padding: 12px; margin-bottom: 12px;">
                        <div style="font-size: 11px; color: var(--text-secondary); margin-bottom: 6px; font-weight: 600;">EXAMPLE SUCCESS RESPONSE</div>
                        <pre style="margin: 0; font-family: 'Courier New', monospace; font-size: 11px; color: var(--text-primary); overflow-x: auto; line-height: 1.6;">{
  "success": true,
  "service": "zkML News Classification + Autonomous Trading Demo (x402)",
  "payment": {
    "verified": true,
    "txHash": "0x...",
    "from": "0xYourAddress",
    "amount": "0.25"
  },
  "classification": {
    "headline": "Bitcoin ETF approved by SEC",
    "sentiment": "GOOD_NEWS",
    "confidence": 89,
    "proofHash": "0x...",
    "classificationId": "0xabc123...",
    "oracleTxHash": "0xdef456..."
  },
  "autonomousTrade": {
    "triggered": true,
    "txHash": "0x789xyz...",
    "action": "BUY",
    "basescanUrl": "https://basescan.org/tx/0x789xyz...",
    "blockNumber": 12345678
  }
}</pre>
                    </div>

                    <div style="background: rgba(239, 68, 68, 0.1); border: 1px solid var(--accent-red); border-radius: 8px; padding: 12px;">
                        <div style="font-size: 11px; color: var(--accent-red); margin-bottom: 6px; font-weight: 600;">HTTP 402 PAYMENT REQUIRED</div>
                        <pre style="margin: 0; font-family: 'Courier New', monospace; font-size: 11px; color: var(--text-primary); overflow-x: auto; line-height: 1.6;">{
  "status": 402,
  "message": "Payment Required",
  "payment": {
    "price": "$0.25",
    "currency": "USDC",
    "recipient": "0x4E3eD682f723DD133252aae032D32f1Ef7EEafb4"
  }
}</pre>
                    </div>
                </div>

                <!-- Payment Flow -->
                <div style="background: linear-gradient(135deg, rgba(91, 140, 255, 0.1), rgba(77, 226, 207, 0.1)); border: 1px solid var(--accent-teal); border-radius: 12px; padding: 20px; margin-bottom: 24px;">
                    <h3 style="font-size: 16px; font-weight: 700; margin-bottom: 16px; color: var(--text-primary);">💳 Payment Flow</h3>
                    <ol style="margin: 0; padding-left: 20px; font-size: 13px; color: var(--text-primary); line-height: 1.8;">
                        <li>GET <code style="background: var(--bg-tertiary); padding: 2px 6px; border-radius: 4px; font-size: 12px;">/api/pricing</code> to get payment details</li>
                        <li>Send <strong>$0.25 USDC</strong> on <strong>Base Mainnet</strong> to recipient address</li>
                        <li>Copy your USDC transfer transaction hash</li>
                        <li>POST to <code style="background: var(--bg-tertiary); padding: 2px 6px; border-radius: 4px; font-size: 12px;">/api/classify</code> with headline and tx hash</li>
                        <li>Receive zkML classification with cryptographic proof</li>
                    </ol>
                </div>

                <!-- JavaScript Integration Example -->
                <div style="margin-bottom: 24px;">
                    <h3 style="font-size: 16px; font-weight: 700; margin-bottom: 12px; color: var(--text-primary);">🔧 JavaScript Integration</h3>
                    <div style="background: var(--bg-primary); border: 1px solid var(--border-color); border-radius: 8px; padding: 12px;">
                        <pre style="margin: 0; font-family: 'Courier New', monospace; font-size: 11px; color: var(--text-primary); overflow-x: auto; line-height: 1.6;">// Step 1: Get pricing info
const pricing = await fetch('http://localhost:3000/api/pricing')
  .then(r => r.json());

// Step 2: Send USDC payment using ethers.js
const usdc = new ethers.Contract(
  pricing.usdcAddress,
  ['function transfer(address to, uint256 amount)'],
  signer
);
const tx = await usdc.transfer(
  pricing.recipient,
  ethers.parseUnits('0.25', 6)
);
await tx.wait();

// Step 3: Request classification
const result = await fetch('http://localhost:3000/api/classify', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    headline: 'Your news headline here',
    paymentTx: tx.hash
  })
}).then(r => r.json());

console.log(result.classification);
// { sentiment: "GOOD_NEWS", confidence: 89, proofHash: "0x..." }</pre>
                    </div>
                </div>

                <!-- Demo Endpoint -->
                <div style="background: rgba(255, 193, 7, 0.1); border: 1px solid var(--accent-yellow); border-radius: 12px; padding: 16px;">
                    <h3 style="font-size: 14px; font-weight: 700; margin-bottom: 8px; color: var(--accent-yellow);">🎬 Free Demo Endpoint</h3>
                    <p style="font-size: 12px; color: var(--text-secondary); margin-bottom: 8px;">For testing without payment:</p>
                    <code style="font-family: 'Courier New', monospace; color: var(--text-primary); font-size: 12px;">POST http://localhost:3000/api/demo/classify</code>
                </div>
            </div>
        </div>

        <!-- Contract Addresses -->
        <div class="dashboard-card">
            <div class="card-header">
                <h2 class="card-title">
                    📋 Contract Addresses
                    <span class="info-icon">ⓘ
                        <span class="tooltip">These are the blockchain addresses of all smart contracts powering this system. Each address is on Base Mainnet. Click any address to view it on BaseScan, the blockchain explorer. All code is transparent and verifiable on-chain.</span>
                    </span>
                </h2>
                <span class="card-badge registry">BASE</span>
            </div>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 16px;">
                <div class="portfolio-item">
                    <div class="portfolio-label">📰 News Oracle</div>
                    <a href="https://basescan.org/address/0x93Efb961780a19052A2fBd186A86b7edf073EFb6" target="_blank" style="text-decoration: none;">
                        <div class="proof-hash" id="oracle-address" style="color: var(--accent-blue); cursor: pointer; transition: color 0.2s;" onmouseover="this.style.color='var(--accent-teal)'" onmouseout="this.style.color='var(--accent-blue)'">0x93Efb961780a19052A2fBd186A86b7edf073EFb6</div>
                    </a>
                </div>
                <div class="portfolio-item">
                    <div class="portfolio-label">💼 Trading Agent</div>
                    <a href="https://basescan.org/address/0xBC2a8f872f02CCd2356F235675f756A4FdCAd81d" target="_blank" style="text-decoration: none;">
                        <div class="proof-hash" id="agent-address" style="color: var(--accent-blue); cursor: pointer; transition: color 0.2s;" onmouseover="this.style.color='var(--accent-teal)'" onmouseout="this.style.color='var(--accent-blue)'">0xBC2a8f872f02CCd2356F235675f756A4FdCAd81d</div>
                    </a>
                </div>
                <div class="portfolio-item">
                    <div class="portfolio-label">🔐 Groth16 Verifier</div>
                    <a href="https://basescan.org/address/0x80DA3C348D132172A21868cb318874b20FE1F177" target="_blank" style="text-decoration: none;">
                        <div class="proof-hash" style="color: var(--accent-blue); cursor: pointer; transition: color 0.2s;" onmouseover="this.style.color='var(--accent-teal)'" onmouseout="this.style.color='var(--accent-blue)'">0x80DA3C348D132172A21868cb318874b20FE1F177</div>
                    </a>
                </div>
                <div class="portfolio-item">
                    <div class="portfolio-label">✅ News Verifier</div>
                    <a href="https://basescan.org/address/0x42706c5d80CC618e51d178bd9869894692A77a5c" target="_blank" style="text-decoration: none;">
                        <div class="proof-hash" style="color: var(--accent-blue); cursor: pointer; transition: color 0.2s;" onmouseover="this.style.color='var(--accent-teal)'" onmouseout="this.style.color='var(--accent-blue)'">0x42706c5d80CC618e51d178bd9869894692A77a5c</div>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <script>
        // API Base URL
        const API_URL = 'http://localhost:3001';

        // Auto-refresh interval (10 seconds)
        const REFRESH_INTERVAL = 10000;

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            console.log('🚀 zkML News Oracle UI initialized');
            loadDashboard();
            loadX402Pricing();
            startAutoRefresh();
        });

        // Load all dashboard data
        async function loadDashboard() {
            try {
                await Promise.all([
                    loadStats(),
                    loadClassifications(),
                    loadTrades(),
                    loadPortfolio(),
                    loadRegistry(),
                    loadValidations()
                ]);
            } catch (error) {
                console.error('Error loading dashboard:', error);
            }
        }

        // Load latest classification
        async function loadLatestClassification() {
            try {
                const response = await fetch(`${API_URL}/api/latest-classification`);
                const data = await response.json();

                const card = document.getElementById('latest-classification-card');
                const contentEl = document.getElementById('latest-classification-content');

                if (!data.classification) {
                    card.style.display = 'none';
                    return;
                }

                card.style.display = 'block';
                const c = data.classification;
                const zkmlBadge = c.isZkmlVerified
                    ? '<span style="color: var(--accent-green); font-weight: 600; margin-left: 12px;">✓ zkML Verified</span>'
                    : '<span style="color: var(--accent-yellow); font-weight: 600; margin-left: 12px;">⏳ Verification Pending</span>';

                contentEl.innerHTML = `
                    <div style="background: var(--bg-tertiary); border: 2px solid var(--accent-blue); border-radius: 12px; padding: 24px;">
                        <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 16px;">
                            <div style="flex: 1;">
                                <div style="font-size: 18px; font-weight: 700; margin-bottom: 8px; color: var(--text-primary);">
                                    ${c.headline}
                                    ${zkmlBadge}
                                </div>
                                <div style="display: flex; gap: 24px; flex-wrap: wrap; margin-top: 16px;">
                                    <div>
                                        <div style="font-size: 11px; color: var(--text-secondary); text-transform: uppercase; margin-bottom: 4px;">Sentiment</div>
                                        <span class="sentiment-badge ${c.sentiment.toLowerCase()}" style="font-size: 14px; padding: 6px 16px;">${c.sentiment}</span>
                                    </div>
                                    <div>
                                        <div style="font-size: 11px; color: var(--text-secondary); text-transform: uppercase; margin-bottom: 4px;">Confidence</div>
                                        <div style="font-size: 18px; font-weight: 700; color: var(--accent-teal);">${c.confidence}%</div>
                                    </div>
                                    <div>
                                        <div style="font-size: 11px; color: var(--text-secondary); text-transform: uppercase; margin-bottom: 4px;">Oracle Token</div>
                                        <div style="font-size: 18px; font-weight: 700;">#${c.oracleTokenId}</div>
                                    </div>
                                    <div>
                                        <div style="font-size: 11px; color: var(--text-secondary); text-transform: uppercase; margin-bottom: 4px;">Timestamp</div>
                                        <div style="font-size: 14px;">${new Date(c.timestamp * 1000).toLocaleString()}</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 16px; margin-top: 20px; padding-top: 20px; border-top: 1px solid var(--border-color);">
                            <div style="background: var(--bg-primary); padding: 16px; border-radius: 8px;">
                                <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 8px;">🔐 Proof Hash</div>
                                <div class="proof-hash" style="color: var(--accent-teal);">${c.proofHash}</div>
                            </div>
                            <div style="background: var(--bg-primary); padding: 16px; border-radius: 8px;">
                                <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 8px;">📝 Classification TX</div>
                                <a href="${c.explorerUrl}" target="_blank" style="color: var(--accent-blue); text-decoration: none; font-family: 'Courier New', monospace; font-size: 12px; display: flex; align-items: center; gap: 6px;">
                                    ${c.txHash}
                                    <span style="font-size: 14px;">↗</span>
                                </a>
                            </div>
                            ${c.verificationTxHash ? `
                                <div style="background: var(--bg-primary); padding: 16px; border-radius: 8px;">
                                    <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 8px;">✅ Verification TX</div>
                                    <a href="${c.verificationExplorerUrl}" target="_blank" style="color: var(--accent-blue); text-decoration: none; font-family: 'Courier New', monospace; font-size: 12px; display: flex; align-items: center; gap: 6px;">
                                        ${c.verificationTxHash}
                                        <span style="font-size: 14px;">↗</span>
                                    </a>
                                </div>
                            ` : ''}
                        </div>

                        <div style="margin-top: 16px; padding: 12px; background: rgba(91, 140, 255, 0.1); border-radius: 8px; border-left: 4px solid var(--accent-blue);">
                            <div style="font-size: 12px; color: var(--text-secondary);">
                                ℹ️ This classification was generated using <strong>real ONNX neural network</strong> inference, proven with <strong>JOLT zkML proof</strong> (~20s), wrapped in <strong>Groth16 zkSNARK</strong> (~1.5s), and verified on-chain at Base Mainnet.
                            </div>
                        </div>
                    </div>
                `;
            } catch (error) {
                console.error('Error loading latest classification:', error);
                document.getElementById('latest-classification-card').style.display = 'none';
            }
        }

        // Load statistics
        async function loadStats() {
            try {
                const response = await fetch(`${API_URL}/api/stats`);
                const data = await response.json();

                document.getElementById('total-classifications').textContent = data.totalClassifications || '0';

                // Oracle reputation with verification stats
                const oracleReputation = data.oracleReputation || '0';
                const oracleProofs = data.oracleProofsSubmitted || '0';
                const oracleAccuracy = data.oracleAccuracy || '0';

                document.getElementById('oracle-reputation').textContent = `${oracleReputation}/1000`;
                document.getElementById('oracle-proofs').textContent = `${oracleProofs} proofs`;
                document.getElementById('oracle-accuracy').textContent = oracleAccuracy > 0 ? `${oracleAccuracy}% accurate` : 'N/A';

                document.getElementById('total-trades').textContent = data.totalTrades || '0';
                document.getElementById('win-rate').textContent = `${data.winRate || '0'}%`;
            } catch (error) {
                console.error('Error loading stats:', error);
            }
        }

        // Load classifications
        async function loadClassifications() {
            try {
                const response = await fetch(`${API_URL}/api/classifications`);
                const data = await response.json();

                const listEl = document.getElementById('classification-list');

                if (!data.classifications || data.classifications.length === 0) {
                    listEl.innerHTML = '<div class="empty-state"><div class="empty-state-icon">📊</div><p>No classifications yet</p></div>';
                    return;
                }

                listEl.innerHTML = data.classifications.map(c => {
                    const zkmlBadge = c.isZkmlVerified
                        ? '<span style="color: var(--accent-green); font-size: 11px; margin-left: 8px;">✓ zkML</span>'
                        : '';

                    return `
                    <div class="classification-item">
                        <div class="classification-header">
                            <div class="classification-headline">${c.headline}${zkmlBadge}</div>
                            <div style="display: flex; flex-direction: column; align-items: flex-end; gap: 4px;">
                                <span class="sentiment-badge ${c.sentiment.toLowerCase()}">${c.sentiment}</span>
                                <span style="font-size: 11px; color: var(--text-secondary); font-weight: 600;">${c.confidence}% confidence</span>
                            </div>
                        </div>
                        <div class="classification-meta">
                            <span>🔐 Proof: ${c.proofHash.slice(0, 10)}...</span>
                            <span>⏰ ${new Date(c.timestamp * 1000).toLocaleString()}</span>
                        </div>
                        <div style="margin-top: 8px;">
                            <a href="${c.explorerUrl}" target="_blank" style="color: var(--accent-blue); text-decoration: none; font-size: 12px; display: inline-flex; align-items: center; gap: 4px;">
                                🔗 View on BaseScan
                                <span style="font-family: 'Courier New', monospace;">${c.txHash ? c.txHash.slice(0, 10) + '...' : ''}</span>
                            </a>
                        </div>
                    </div>
                    `;
                }).join('');
            } catch (error) {
                console.error('Error loading classifications:', error);
            }
        }

        // Load trades
        async function loadTrades() {
            try {
                const response = await fetch(`${API_URL}/api/trades`);
                const data = await response.json();

                const listEl = document.getElementById('trade-list');

                if (!data.trades || data.trades.length === 0) {
                    listEl.innerHTML = '<div class="empty-state"><div class="empty-state-icon">💹</div><p>No trades yet</p></div>';
                    return;
                }

                listEl.innerHTML = data.trades.map(t => {
                    const pnlClass = t.isProfitable ? 'positive' : (t.portfolioValueAfter > 0 ? 'negative' : 'pending');
                    const pnlText = t.portfolioValueAfter > 0
                        ? (t.isProfitable ? `+${t.profitPercent}%` : `${t.profitPercent}%`)
                        : 'Pending Evaluation';

                    // Make action human-readable
                    let actionText = t.action;
                    let actionEmoji = '💱';
                    if (t.action.includes('SELL_ETH') || t.action.includes('ETH') && t.action.includes('SELL')) {
                        actionText = `Sold ${t.amountIn} ETH → ${t.amountOut} USDC`;
                        actionEmoji = '📉';
                    } else if (t.action.includes('BUY_ETH') || t.action.includes('ETH') && t.action.includes('BUY')) {
                        actionText = `Bought ${t.amountOut} ETH ← ${t.amountIn} USDC`;
                        actionEmoji = '📈';
                    } else if (t.action.includes('HOLD')) {
                        actionText = 'Hold Position';
                        actionEmoji = '⏸️';
                    }

                    return `
                        <div class="trade-item">
                            <div class="trade-header">
                                <div class="trade-action">${actionEmoji} ${actionText}</div>
                                <div class="trade-pnl ${pnlClass}">${pnlText}</div>
                            </div>
                            <div class="trade-details">
                                <div>📊 Sentiment: ${t.sentiment}</div>
                                <div>⏰ ${new Date(t.timestamp * 1000).toLocaleString()}</div>
                                <div>💼 Value Before: $${t.portfolioValueBefore}</div>
                                <div>💼 Value After: $${t.portfolioValueAfter > 0 ? t.portfolioValueAfter : 'Pending'}</div>
                            </div>
                            ${t.txHash && t.txHash !== '0x' ? `
                                <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid var(--border-color);">
                                    <a href="${t.explorerUrl}" target="_blank" style="color: var(--accent-blue); text-decoration: none; font-size: 12px; display: inline-flex; align-items: center; gap: 4px;">
                                        🔗 View on BaseScan
                                        <span style="font-family: 'Courier New', monospace;">${t.txHash.slice(0, 10)}...</span>
                                    </a>
                                </div>
                            ` : ''}
                        </div>
                    `;
                }).join('');
            } catch (error) {
                console.error('Error loading trades:', error);
            }
        }

        // Load portfolio
        async function loadPortfolio() {
            try {
                const response = await fetch(`${API_URL}/api/portfolio`);
                const data = await response.json();

                document.getElementById('weth-balance').textContent = `${data.wethBalance || '0'} ETH`;
                document.getElementById('usdc-balance').textContent = `${data.usdcBalance || '0'} USDC`;
                document.getElementById('total-value').textContent = `$${data.totalValue || '0'}`;
                document.getElementById('pnl-24h').textContent = data.pnl24h ? `${data.pnl24h > 0 ? '+' : ''}${data.pnl24h}%` : '-';
            } catch (error) {
                console.error('Error loading portfolio:', error);
            }
        }

        // Load registry
        async function loadRegistry() {
            try {
                const response = await fetch(`${API_URL}/api/registry`);
                const data = await response.json();

                const tbody = document.getElementById('registry-tbody');

                if (!data.agents || data.agents.length === 0) {
                    tbody.innerHTML = '<tr><td colspan="3"><div class="empty-state"><div class="empty-state-icon">🔐</div><p>No agents registered</p></div></td></tr>';
                    return;
                }

                tbody.innerHTML = data.agents.map(a => `
                    <tr>
                        <td>
                            <a href="https://basescan.org/token/0x98879bE272B30844D3d3BBcDD849827b524F43B5?a=${a.tokenId}" target="_blank" style="color: var(--accent-blue); text-decoration: none; font-weight: 600;" onmouseover="this.style.color='var(--accent-teal)'" onmouseout="this.style.color='var(--accent-blue)'">
                                #${a.tokenId}
                            </a>
                        </td>
                        <td>${a.capability}</td>
                        <td>
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <span>${a.reputation}/1000</span>
                                <div class="reputation-bar" style="flex: 1;">
                                    <div class="reputation-fill" style="width: ${(a.reputation / 1000) * 100}%"></div>
                                </div>
                            </div>
                        </td>
                    </tr>
                `).join('');
            } catch (error) {
                console.error('Error loading registry:', error);
            }
        }

        // Load validations
        async function loadValidations() {
            try {
                const response = await fetch(`${API_URL}/api/validations`);
                const data = await response.json();

                const tbody = document.getElementById('validations-tbody');

                if (!data.validations || data.validations.length === 0) {
                    tbody.innerHTML = '<tr><td colspan="5"><div class="empty-state"><div class="empty-state-icon">📭</div><p>No validation requests yet</p></div></td></tr>';
                    return;
                }

                tbody.innerHTML = data.validations.map(v => {
                    const statusLabels = ['Pending', 'Validated', 'Rejected'];
                    const statusColors = ['var(--accent-yellow)', 'var(--accent-green)', 'var(--accent-red)'];
                    const statusIcons = ['⏳', '✅', '❌'];

                    const status = statusLabels[v.status] || 'Unknown';
                    const color = statusColors[v.status] || 'var(--text-secondary)';
                    const icon = statusIcons[v.status] || '❓';

                    const shortId = v.classificationId.substring(0, 10) + '...' + v.classificationId.substring(v.classificationId.length - 8);
                    const timeAgo = formatTimeAgo(v.requestTime);

                    return `
                    <tr>
                        <td>
                            <div style="font-family: monospace; font-size: 12px;">${shortId}</div>
                        </td>
                        <td>#${v.agentTokenId}</td>
                        <td>
                            <span style="color: ${color};">${icon} ${status}</span>
                        </td>
                        <td>${v.responseCount}</td>
                        <td>${timeAgo}</td>
                    </tr>
                `;
                }).join('');
            } catch (error) {
                console.error('Error loading validations:', error);
                const tbody = document.getElementById('validations-tbody');
                tbody.innerHTML = '<tr><td colspan="5"><div class="empty-state"><div class="empty-state-icon">⚠️</div><p>Error loading validations</p></div></td></tr>';
            }
        }

        // Helper function to format time ago
        function formatTimeAgo(timestamp) {
            const now = Math.floor(Date.now() / 1000);
            const seconds = now - timestamp;

            if (seconds < 60) return `${seconds}s ago`;
            if (seconds < 3600) return `${Math.floor(seconds / 60)}m ago`;
            if (seconds < 86400) return `${Math.floor(seconds / 3600)}h ago`;
            return `${Math.floor(seconds / 86400)}d ago`;
        }

        // Start auto-refresh
        function startAutoRefresh() {
            setInterval(loadDashboard, REFRESH_INTERVAL);
        }

        // Animate workflow steps
        function animateWorkflow() {
            const steps = ['step-1', 'step-2', 'step-3', 'step-4', 'step-5'];
            let currentStep = 0;

            setInterval(() => {
                steps.forEach(id => document.getElementById(id).classList.remove('active'));
                document.getElementById(steps[currentStep]).classList.add('active');
                currentStep = (currentStep + 1) % steps.length;
            }, 2000);
        }

        animateWorkflow();

        // Proof Generation Banner Management
        let proofStartTime = null;
        let proofTimerInterval = null;
        let lastClassificationCount = 0;

        async function checkProofGeneration() {
            try {
                const response = await fetch(`${API_URL}/api/stats`);
                const data = await response.json();
                const currentCount = parseInt(data.totalClassifications) || 0;

                // If classification count increased, a proof just completed
                if (currentCount > lastClassificationCount) {
                    hideProofBanner();
                    lastClassificationCount = currentCount;
                }
            } catch (error) {
                console.error('Error checking proof generation:', error);
            }
        }

        function showProofBanner() {
            const banner = document.getElementById('proof-banner');
            if (!banner.classList.contains('active')) {
                banner.classList.add('active');
                proofStartTime = Date.now();

                // Start timer
                if (proofTimerInterval) clearInterval(proofTimerInterval);
                proofTimerInterval = setInterval(updateProofTimer, 100);
            }
        }

        function hideProofBanner() {
            const banner = document.getElementById('proof-banner');
            banner.classList.remove('active');

            if (proofTimerInterval) {
                clearInterval(proofTimerInterval);
                proofTimerInterval = null;
            }
            proofStartTime = null;
        }

        function updateProofTimer() {
            if (!proofStartTime) return;

            const elapsed = Math.floor((Date.now() - proofStartTime) / 1000);
            const timerEl = document.getElementById('proof-timer');
            timerEl.textContent = `${elapsed}s`;

            // Auto-hide after 60 seconds (proof likely failed or completed elsewhere)
            if (elapsed > 60) {
                hideProofBanner();
            }
        }

        // Simulated demo: Show proof banner periodically to demonstrate the feature
        // In production, this would be triggered by backend events
        function startProofDemo() {
            // Show banner for 25 seconds every 5 minutes to demonstrate
            setInterval(() => {
                showProofBanner();
                setTimeout(() => {
                    hideProofBanner();
                    // Trigger dashboard reload to show new data
                    loadDashboard();
                }, 25000); // 25 seconds (typical proof generation time)
            }, 300000); // Every 5 minutes
        }

        // Check for proof generation status periodically
        setInterval(checkProofGeneration, 5000);

        // Initialize proof generation tracking
        (async () => {
            try {
                const response = await fetch(`${API_URL}/api/stats`);
                const data = await response.json();
                lastClassificationCount = parseInt(data.totalClassifications) || 0;
            } catch (error) {
                console.error('Error initializing proof tracking:', error);
            }
        })();

        // Note: In production, the backend would emit events when proof generation starts
        // For now, users can manually trigger by visiting the service

        // ===== x402 Payment Service Functions =====

        /**
         * Load x402 pricing information
         */
        async function loadX402Pricing() {
            try {
                const response = await fetch(`${API_URL}/api/pricing`);
                const data = await response.json();

                // Update pricing display
                document.getElementById('x402-price').textContent = `${data.price} ${data.currency || 'USDC'}`;
                document.getElementById('x402-widget-price').textContent = data.price || '$0.25';

                // Use fallback oracle wallet address if recipient is not set
                const recipientAddress = data.recipient || '0x4E3eD682f723DD133252aae032D32f1Ef7EEafb4';
                document.getElementById('x402-recipient').textContent = recipientAddress;

                console.log('💳 x402 pricing loaded:', data);
            } catch (error) {
                console.error('Error loading x402 pricing:', error);
                // Use fallback oracle wallet address on error
                document.getElementById('x402-recipient').textContent = '0x4E3eD682f723DD133252aae032D32f1Ef7EEafb4';
            }
        }

        /**
         * Submit x402 classification request
         */
        async function submitX402Classification() {
            try {
                // Hide previous results/errors
                document.getElementById('x402-results').style.display = 'none';
                document.getElementById('x402-error').style.display = 'none';

                // Get input values
                const headline = document.getElementById('x402-headline').value.trim();
                const paymentTx = document.getElementById('x402-payment-tx').value.trim();

                // Validate inputs
                if (!headline) {
                    showX402Error('Please enter a headline to classify');
                    return;
                }

                // Update button state
                const btn = document.getElementById('x402-submit-btn');
                const originalText = btn.innerHTML;
                btn.disabled = true;
                btn.innerHTML = '<div class="spinner"></div> Processing...';

                // Make API request
                const response = await fetch(`${API_URL}/api/classify`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        headline: headline,
                        paymentTx: paymentTx || undefined
                    })
                });

                const data = await response.json();

                // Reset button
                btn.disabled = false;
                btn.innerHTML = originalText;

                // Handle response
                if (response.status === 402) {
                    // Payment required
                    showX402Error(`
                        <strong>Payment Required (HTTP 402)</strong><br><br>
                        Please send <strong>${data.payment?.price || '0.0001 ETH'}</strong> to:<br>
                        <code style="word-break: break-all; color: var(--accent-teal);">${data.payment?.recipient || 'See above'}</code><br><br>
                        Then enter the transaction hash above and try again.
                    `);
                } else if (!response.ok) {
                    // Other error
                    showX402Error(data.error || data.message || 'Request failed');
                } else if (data.success) {
                    // Success - show results
                    showX402Results(data);
                } else {
                    showX402Error(data.error || 'Unknown error occurred');
                }

            } catch (error) {
                console.error('Error submitting x402 classification:', error);
                showX402Error(`Network error: ${error.message}`);

                // Reset button
                const btn = document.getElementById('x402-submit-btn');
                btn.disabled = false;
                btn.innerHTML = '🚀 Get zkML Classification';
            }
        }

        /**
         * Display x402 classification results
         */
        function showX402Results(data) {
            const resultsDiv = document.getElementById('x402-results');
            const contentDiv = document.getElementById('x402-results-content');

            const classification = data.classification;
            const payment = data.payment;

            contentDiv.innerHTML = `
                <!-- Headline -->
                <div style="margin-bottom: 24px; padding-bottom: 24px; border-bottom: 1px solid var(--border-color);">
                    <div style="font-size: 14px; color: var(--text-secondary); margin-bottom: 8px;">Headline</div>
                    <div style="font-size: 18px; font-weight: 600; color: var(--text-primary);">${classification.headline}</div>
                </div>

                <!-- Classification Results -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-bottom: 24px;">
                    <div style="background: var(--bg-primary); padding: 16px; border-radius: 8px;">
                        <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 8px;">Sentiment</div>
                        <span class="sentiment-badge ${classification.sentiment.toLowerCase().replace('_news', '')}" style="font-size: 16px; padding: 8px 16px;">
                            ${classification.sentiment}
                        </span>
                    </div>
                    <div style="background: var(--bg-primary); padding: 16px; border-radius: 8px;">
                        <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 8px;">Confidence</div>
                        <div style="font-size: 24px; font-weight: 700; color: var(--accent-teal);">${classification.confidence}%</div>
                    </div>
                </div>

                <!-- zkML Proof -->
                <div style="background: var(--bg-primary); padding: 16px; border-radius: 8px; margin-bottom: 24px;">
                    <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 8px;">🔐 zkML Proof Hash</div>
                    <div class="proof-hash" style="color: var(--accent-teal);">${classification.proofHash}</div>
                </div>

                <!-- Payment Verification -->
                <div style="background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(77, 226, 207, 0.1)); border: 1px solid var(--accent-green); border-radius: 8px; padding: 16px; margin-bottom: 20px;">
                    <div style="font-size: 14px; font-weight: 700; color: var(--accent-green); margin-bottom: 12px;">
                        ✅ USDC Payment Verified
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 10px; font-size: 12px;">
                        <div>
                            <div style="color: var(--text-secondary); margin-bottom: 4px;">From</div>
                            <div class="proof-hash" style="font-size: 10px; color: var(--text-primary);">${payment.from}</div>
                        </div>
                        <div>
                            <div style="color: var(--text-secondary); margin-bottom: 4px;">Amount</div>
                            <div style="font-weight: 600; color: var(--accent-green);">$${payment.amount} USDC</div>
                        </div>
                        <div>
                            <div style="color: var(--text-secondary); margin-bottom: 4px;">Transaction</div>
                            <a href="https://basescan.org/tx/${payment.txHash}" target="_blank" style="color: var(--accent-blue); text-decoration: none; font-size: 10px; font-family: 'Courier New', monospace; word-break: break-all;">
                                ${payment.txHash}
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Service Info -->
                <div style="padding: 16px; background: rgba(91, 140, 255, 0.1); border-radius: 8px; border-left: 4px solid var(--accent-blue);">
                    <div style="font-size: 13px; color: var(--text-secondary); line-height: 1.6;">
                        ℹ️ This classification was generated using <strong>JOLT-Atlas zkML</strong> with <strong>Groth16 proof</strong>, verified via <strong>x402 payment protocol</strong> on Base Mainnet.
                    </div>
                </div>
            `;

            resultsDiv.style.display = 'block';

            // Scroll to results
            resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        /**
         * Display x402 error message
         */
        function showX402Error(message) {
            const errorDiv = document.getElementById('x402-error');
            const contentDiv = document.getElementById('x402-error-content');

            contentDiv.innerHTML = message;
            errorDiv.style.display = 'block';

            // Scroll to error
            errorDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }
    </script>

    <!-- About Modal -->
    <div id="about-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.8); z-index: 2000; align-items: center; justify-content: center;">
        <div style="background: var(--bg-secondary); border: 1px solid var(--accent-teal); border-radius: 16px; padding: 32px; max-width: 800px; width: 90%; max-height: 90vh; overflow-y: auto; position: relative;">
            <button onclick="document.getElementById('about-modal').style.display = 'none'" style="position: absolute; top: 16px; right: 16px; background: none; border: none; color: var(--text-secondary); font-size: 24px; cursor: pointer; padding: 0; width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; border-radius: 4px; transition: all 0.2s;" onmouseover="this.style.background='var(--bg-tertiary)'; this.style.color='var(--text-primary)'" onmouseout="this.style.background='none'; this.style.color='var(--text-secondary)'">×</button>

            <div class="card-header" style="border: none; padding: 0; margin-bottom: 24px;">
                <h2 class="card-title" style="color: var(--accent-teal);">
                    📚 About zkML for ERC-8004
                </h2>
                <p style="font-size: 14px; color: var(--text-secondary); margin-top: 8px;">
                    Autonomous verifiable AI agent demonstrating ERC-8004 standard on Base Mainnet
                </p>
            </div>

            <!-- What It Is -->
            <div style="margin-bottom: 32px;">
                <h3 style="font-size: 16px; font-weight: 700; margin-bottom: 12px; color: var(--text-primary);">
                    🤖 What Is This?
                </h3>
                <p style="font-size: 14px; color: var(--text-secondary); line-height: 1.6; margin-bottom: 12px;">
                    This is an <strong style="color: var(--text-primary);">autonomous AI agent</strong> that monitors crypto news, classifies sentiment using zero-knowledge machine learning (zkML), and triggers DeFi trading decisions on Base Mainnet. It demonstrates the <strong style="color: var(--accent-teal);">ERC-8004 standard</strong> for verifiable AI agents with on-chain proof verification.
                </p>
            </div>

            <!-- How It Works -->
            <div style="margin-bottom: 32px;">
                <h3 style="font-size: 16px; font-weight: 700; margin-bottom: 12px; color: var(--text-primary);">
                    ⚙️ How It Works (Autonomous Mode)
                </h3>
                <div style="background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 12px; padding: 20px;">
                    <div style="display: flex; flex-direction: column; gap: 16px;">
                        <div style="display: flex; gap: 12px;">
                            <div style="color: var(--accent-teal); font-size: 20px; min-width: 24px;">1️⃣</div>
                            <div>
                                <div style="font-weight: 600; color: var(--text-primary); margin-bottom: 4px;">News Fetching</div>
                                <div style="font-size: 13px; color: var(--text-secondary);">Service polls CoinDesk RSS feed every 5 minutes for latest crypto news</div>
                            </div>
                        </div>
                        <div style="display: flex; gap: 12px;">
                            <div style="color: var(--accent-blue); font-size: 20px; min-width: 24px;">2️⃣</div>
                            <div>
                                <div style="font-weight: 600; color: var(--text-primary); margin-bottom: 4px;">zkML Classification</div>
                                <div style="font-size: 13px; color: var(--text-secondary);">Headlines are classified as BULLISH, BEARISH, or NEUTRAL using JOLT-Atlas zkVM with Groth16 proofs</div>
                            </div>
                        </div>
                        <div style="display: flex; gap: 12px;">
                            <div style="color: var(--accent-green); font-size: 20px; min-width: 24px;">3️⃣</div>
                            <div>
                                <div style="font-weight: 600; color: var(--text-primary); margin-bottom: 4px;">On-Chain Oracle</div>
                                <div style="font-size: 13px; color: var(--text-secondary);">Classification and proof are posted to NewsOracle smart contract on Base Mainnet</div>
                            </div>
                        </div>
                        <div style="display: flex; gap: 12px;">
                            <div style="color: var(--accent-purple); font-size: 20px; min-width: 24px;">4️⃣</div>
                            <div>
                                <div style="font-weight: 600; color: var(--text-primary); margin-bottom: 4px;">Autonomous Trading</div>
                                <div style="font-size: 13px; color: var(--text-secondary);">TradingAgent contract reacts to sentiment by executing WETH/USDC trades on Uniswap V3</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Paid Testing Feature -->
            <div style="margin-bottom: 32px;">
                <h3 style="font-size: 16px; font-weight: 700; margin-bottom: 12px; color: var(--text-primary);">
                    💳 Paid Testing (x402 Service)
                </h3>
                <p style="font-size: 14px; color: var(--text-secondary); line-height: 1.6; margin-bottom: 12px;">
                    Users and AI agents can test custom headlines and see how the autonomous system responds. Submit any headline for just <strong style="color: var(--accent-green);">$0.25 USDC</strong> using the <strong style="color: var(--accent-teal);">HTTP 402 Payment Required</strong> protocol:
                </p>
                <ul style="list-style: none; padding: 0; margin: 0;">
                    <li style="padding: 8px 0; font-size: 13px; color: var(--text-secondary); display: flex; gap: 8px;">
                        <span style="color: var(--accent-teal);">•</span>
                        <span>Send $0.25 USDC to the payment recipient on Base Mainnet</span>
                    </li>
                    <li style="padding: 8px 0; font-size: 13px; color: var(--text-secondary); display: flex; gap: 8px;">
                        <span style="color: var(--accent-teal);">•</span>
                        <span>Submit your custom headline + payment transaction hash</span>
                    </li>
                    <li style="padding: 8px 0; font-size: 13px; color: var(--text-secondary); display: flex; gap: 8px;">
                        <span style="color: var(--accent-teal);">•</span>
                        <span>Get instant zkML classification with on-chain proof</span>
                    </li>
                    <li style="padding: 8px 0; font-size: 13px; color: var(--text-secondary); display: flex; gap: 8px;">
                        <span style="color: var(--accent-teal);">•</span>
                        <span>Watch the autonomous trading agent react in real-time</span>
                    </li>
                </ul>
                <p style="font-size: 13px; color: var(--text-secondary); line-height: 1.6; margin-top: 12px; padding: 12px; background: rgba(77, 226, 207, 0.1); border-radius: 8px; border-left: 3px solid var(--accent-teal);">
                    <strong style="color: var(--accent-teal);">Try it now!</strong> Use the "x402 Service" widget above or check the "API Docs" for programmatic access.
                </p>
            </div>

            <!-- Tech Stack -->
            <div style="margin-bottom: 32px;">
                <h3 style="font-size: 16px; font-weight: 700; margin-bottom: 12px; color: var(--text-primary);">
                    🛠️ Technology Stack
                </h3>
                <div style="background: var(--bg-primary); border: 1px solid var(--border-color); border-radius: 12px; padding: 16px;">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;">
                        <div>
                            <div style="font-weight: 600; color: var(--accent-blue); margin-bottom: 6px; font-size: 13px;">zkML Framework</div>
                            <div style="font-size: 13px; color: var(--text-secondary);">JOLT-Atlas zkVM<br>Groth16 Proofs</div>
                        </div>
                        <div>
                            <div style="font-weight: 600; color: var(--accent-blue); margin-bottom: 6px; font-size: 13px;">Blockchain</div>
                            <div style="font-size: 13px; color: var(--text-secondary);">Base Mainnet<br>Chain ID: 8453</div>
                        </div>
                        <div>
                            <div style="font-weight: 600; color: var(--accent-blue); margin-bottom: 6px; font-size: 13px;">Standard</div>
                            <div style="font-size: 13px; color: var(--text-secondary);">ERC-8004<br>Verifiable AI Agents</div>
                        </div>
                        <div>
                            <div style="font-weight: 600; color: var(--accent-blue); margin-bottom: 6px; font-size: 13px;">Payment</div>
                            <div style="font-size: 13px; color: var(--text-secondary);">HTTP 402 Protocol<br>USDC on Base</div>
                        </div>
                        <div>
                            <div style="font-weight: 600; color: var(--accent-blue); margin-bottom: 6px; font-size: 13px;">DeFi</div>
                            <div style="font-size: 13px; color: var(--text-secondary);">Uniswap V3<br>WETH/USDC Pool</div>
                        </div>
                        <div>
                            <div style="font-weight: 600; color: var(--accent-blue); margin-bottom: 6px; font-size: 13px;">Data Source</div>
                            <div style="font-size: 13px; color: var(--text-secondary);">CoinDesk RSS<br>5-minute polling</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ERC-8004 Explanation -->
            <div style="margin-bottom: 32px;">
                <h3 style="font-size: 16px; font-weight: 700; margin-bottom: 12px; color: var(--text-primary);">
                    📜 What is ERC-8004?
                </h3>
                <p style="font-size: 14px; color: var(--text-secondary); line-height: 1.6; margin-bottom: 12px;">
                    <strong style="color: var(--accent-teal);">ERC-8004</strong> is a proposed Ethereum standard for <strong>Verifiable AI Agents</strong>. It enables AI models to prove their computations using zero-knowledge proofs, ensuring:
                </p>
                <ul style="list-style: none; padding: 0; margin: 0;">
                    <li style="padding: 8px 0; font-size: 13px; color: var(--text-secondary); display: flex; gap: 8px;">
                        <span style="color: var(--accent-green);">✓</span>
                        <span><strong style="color: var(--text-primary);">Verifiability:</strong> Anyone can verify the AI's decision was computed correctly</span>
                    </li>
                    <li style="padding: 8px 0; font-size: 13px; color: var(--text-secondary); display: flex; gap: 8px;">
                        <span style="color: var(--accent-green);">✓</span>
                        <span><strong style="color: var(--text-primary);">Privacy:</strong> Model weights and inputs remain private using zero-knowledge cryptography</span>
                    </li>
                    <li style="padding: 8px 0; font-size: 13px; color: var(--text-secondary); display: flex; gap: 8px;">
                        <span style="color: var(--accent-green);">✓</span>
                        <span><strong style="color: var(--text-primary);">Trust:</strong> On-chain verification enables trustless AI-driven DeFi applications</span>
                    </li>
                    <li style="padding: 8px 0; font-size: 13px; color: var(--text-secondary); display: flex; gap: 8px;">
                        <span style="color: var(--accent-green);">✓</span>
                        <span><strong style="color: var(--text-primary);">Composability:</strong> AI agents can interact with smart contracts autonomously</span>
                    </li>
                </ul>
            </div>

            <!-- Links & Resources -->
            <div style="background: linear-gradient(135deg, rgba(91, 140, 255, 0.1), rgba(77, 226, 207, 0.1)); border: 1px solid var(--accent-blue); border-radius: 12px; padding: 20px;">
                <h3 style="font-size: 15px; font-weight: 700; margin-bottom: 16px; color: var(--text-primary);">
                    🔗 Learn More
                </h3>
                <div style="display: flex; flex-direction: column; gap: 12px;">
                    <a href="https://github.com/hshadab/zkml-erc8004" target="_blank" style="color: var(--accent-blue); text-decoration: none; font-size: 14px; display: flex; align-items: center; gap: 8px; transition: all 0.2s;" onmouseover="this.style.color='var(--accent-teal)'" onmouseout="this.style.color='var(--accent-blue)'">
                        <span>📂</span>
                        <span>GitHub Repository - Full source code & documentation</span>
                    </a>
                    <a href="https://basescan.org/address/0xe92c7aE9E894a8701583a43363676ff878d5b6ed" target="_blank" style="color: var(--accent-blue); text-decoration: none; font-size: 14px; display: flex; align-items: center; gap: 8px; transition: all 0.2s;" onmouseover="this.style.color='var(--accent-teal)'" onmouseout="this.style.color='var(--accent-blue)'">
                        <span>🔍</span>
                        <span>NewsOracle Contract on BaseScan</span>
                    </a>
                    <a href="https://basescan.org/address/0x0D43DC16eFC1322Df3CE2B2852558993918A122B" target="_blank" style="color: var(--accent-blue); text-decoration: none; font-size: 14px; display: flex; align-items: center; gap: 8px; transition: all 0.2s;" onmouseover="this.style.color='var(--accent-teal)'" onmouseout="this.style.color='var(--accent-blue)'">
                        <span>🤝</span>
                        <span>TradingAgent Contract on BaseScan</span>
                    </a>
                </div>
            </div>
        </div>
    </div>

</body>
</html>
